/*! Google Maps Pro - v2.9.4
 * https://cp-psource.github.io/ps-maps/
 * Copyright (c) 2017; * Licensed GPLv2+ */
jQuery((function(){var e=!1,t=null,n=null,a=jQuery("#wp-content-media-buttons");function i(){t.size(740,jQuery(window).height()-100)}function o(){jQuery.post(window.ajaxurl,{action:"agm_list_maps"},s)}function s(e){if(null!==n){var t,a=e.maps?e.maps.length:0,i=e.total?parseInt(e.total,10):0,o=jQuery(".agm-paging_bar",n),d=jQuery(".maps_existing_result",n),r=o.length?parseInt(o.attr("data-increment"),10):0,c=r+1,l=r-1;if(i){t=jQuery("<ul></ul>");for(var _=0;_<e.maps.length;_+=1){var u=e.maps[_];t.append('<li class="existing_map_item"><div class="map_item_title"><a href="#" class="edit_map_item" title="'+l10nEditor.preview_or_edit+'">'+u.title+'</a></div><a href="#" title="'+l10nEditor.use_this_map+'"><code class="map-shortcode add_map_item">['+_agmConfig.shortcode+' id="<strong>'+u.id+'</strong>"]</code></a><input type="hidden" value="'+u.id+'" /><div class="map_item_actions"><a href="#" class="edit_map_item">'+l10nEditor.preview_or_edit+'</a>&nbsp;|&nbsp;<a href="#" class="add_map_item">'+l10nEditor.use_this_map+'</a><a href="#" class="delete_map_item"><i class="dashicons dashicons-trash"></i>'+l10nEditor.delete_map+"</a></div></li>")}}else(t=jQuery('<div class="tc"></div>')).append(l10nEditor.no_maps);d.empty().append(t),i>a&&((o=jQuery('<div class="agm-paging_bar" data-increment="'+r+'" />')).appendTo(d),l>=0&&jQuery('<a href="#" class="agm-load_prev_maps">'+l10nEditor.load_prev_maps+"</a>").appendTo(o).bind("click",(function(){return o.attr("data-increment",l),jQuery.post(window.ajaxurl,{action:"agm_list_maps",increment:l},s),!1})),a&&jQuery('<a href="#" class="agm-load_next_maps">'+l10nEditor.load_next_maps+"</a>").appendTo(o).bind("click",(function(){return o.attr("data-increment",c),jQuery.post(window.ajaxurl,{action:"agm_list_maps",increment:c},s),!1}))),a||i||v(),jQuery(window).trigger("resize")}}function d(e,t){return null===n?"":e?t&&t.length?" ["+_agmConfig.shortcode+' id="'+e+'"]'+t+"[/"+_agmConfig.shortcode+"] ":" ["+_agmConfig.shortcode+' id="'+e+'"] ':""}function r(e){if(null!==n){if(!(e=wpmUi.apply_filters("agm-insert-marker",e)||"").length)return!1;window.tinyMCE&&!jQuery("#content").is(":visible")?(window.tinyMCE.activeEditor.selection.getContent(),window.tinyMCE.execCommand("mceInsertContent",!0,e)):function(e,t){if(null===n)return;var a,i;document.selection&&!window.opera?(e.focus(),window.opener.document.selection.createRange().text=t):void 0===e.selectionStart||isNaN(e.selectionStart)?e.value+=t:(a=e.selectionStart,i=e.selectionEnd,e.value=e.value.substring(0,a)+t+e.value.substring(i,e.value.length))}(jQuery("#content").get(0),e)}}function c(a){if(null!==n){void 0!==a.title&&a.title.length?t.title(l10nEditor.edit_map):t.title(l10nEditor.new_map);var i=jQuery(".map_preview_container",n);e&&e.destroy(),e=new window.AgmMapHandler(i,a)}}function l(){var e=0===jQuery("li.existing_map_item .map_advanced_checkbox:checked").length;jQuery(".maps_merge_locations",n).prop("disabled",e),jQuery(".maps_batch_delete",n).prop("disabled",e)}function _(){null!==n&&(n.removeClass("advanced-mode"),jQuery(".map_advanced_checkbox_container",n).remove(),jQuery(".advanced_mode_buttons",n).hide(),jQuery(".existing_map_item.selected",n).removeClass("selected"),jQuery(".existing_map_item.advanced-mode",n).removeClass("advanced-mode"),jQuery(".maps_merge_locations",n).unbind("click"),jQuery(".maps_batch_delete",n).unbind("click"),jQuery(".maps_advanced_mode_help_container",n).html(l10nEditor.advanced_mode_activate_help),jQuery(".maps_advanced_switch .text",n).text(l10nEditor.advanced))}function u(){var t=jQuery("li.existing_map_item .map_advanced_checkbox:checked"),a=[];t.each((function(){a.push(jQuery(this).val())})),jQuery.post(window.ajaxurl,{action:"agm_merge_maps",ids:a},(function(t){var a=jQuery(".map_preview_container",n);_(),p(),e&&e.destroy(),e=new window.AgmMapHandler(a,t),jQuery(".maps_existing",n).hide()}))}function m(){if(null!==n){var e=jQuery("li.existing_map_item .map_advanced_checkbox:checked"),a=[];e.each((function(){a.push(jQuery(this).val())})),t.confirm({message:l10nEditor.batch_delete_confirmation,buttons:[l10nEditor.confirm_delete,l10nEditor.confirm_cancel],callback:function(e){0===e&&function(e){jQuery.post(window.ajaxurl,{action:"agm_batch_delete",ids:e},(function(e){_(),o()}))}(a)}})}}function p(){var t=jQuery(".map_preview_container",n),a=jQuery(".maps_existing",n),i=jQuery(".maps_new_switch_container",n),o=jQuery(".maps_advanced_container",n);e&&e.destroy(),a.hide(),i.hide(),o.hide(),-1!==navigator.userAgent.toLowerCase().indexOf("webkit")&&t.css({height:0,width:0})}function g(){var a,i,s,d;null!==n&&(a=jQuery(".map_preview_container",n),i=jQuery(".maps_existing",n),s=jQuery(".maps_new_switch_container",n),d=jQuery(".maps_advanced_container",n),e&&e.destroy(),i.show(),s.show(),d.show(),t.title(l10nEditor.existing_map),-1!==navigator.userAgent.toLowerCase().indexOf("webkit")&&a.css({height:0,width:0}),o())}function v(){null!==n&&(p(),null!==n&&(jQuery.post(window.ajaxurl,{action:"agm_new_map"},c),jQuery(".maps_new_switch_container",n).hide(),jQuery(".maps_advanced_container",n).hide(),jQuery(".maps_existing",n).hide()))}a.length&&(a.append('<a title="'+l10nEditor.google_maps+'" class="button add_map" href="#"><img alt="'+l10nEditor.google_maps+'" src="'+_agm.root_url+'/img/system/globe-button.gif"></a>'),jQuery("body").append('<div id="map_container_src" style="display:none"><div id="map_container">'+(_agm.is_multisite?"":'<p class="agm_less_important">For more detailed instructions on how to use refer to <a target="_blank" href="https://cp-psource.github.io/ps-maps//#usage">PSOURCE Maps Installation and Use instructions</a>.</p>')+'<div class="agm_container maps_existing"><div class="maps_existing_result"><div class="tc"><img src="'+_agm.root_url+'/img/system/loading.gif" /></div><div class="tc">'+l10nEditor.loading+'</div></div></div><div class="map_preview_container"><div class="map_preview"></div></div><div class="buttons"><span class="maps_advanced_container"><button type="button" class="button-secondary action maps_advanced_switch"data-tooltip="'+l10nEditor.advanced_mode_activate_help+'" data-width="500"><i class="dashicons dashicons-admin-tools"></i> <span class="text">'+l10nEditor.advanced+'</span></button><span class="advanced_mode_buttons" style="display:none"><button type="button" class="button-secondary action maps_merge_locations" data-tooltip="'+l10nEditor.advanced_mode_help+'" data-width="500">'+l10nEditor.merge_locations+'</button><button type="button" class="button-secondary action maps_batch_delete">'+l10nEditor.batch_delete+'</button></span></span><span class="maps_new_switch_container"><button type="button" class="button-secondary action maps_new_switch" data-tooltip="'+l10nEditor.new_map_intro+'" data-width="500"><i class="dashicons dashicons-plus"></i> '+l10nEditor.new_map+"</button></span></div></div></div>"),jQuery(document).on("click",".add_map",(function(){return null===t?(t=wpmUi.popup())&&!t.close&&t.hide&&(t.close=t.hide):t.close(),t.title(l10nEditor.google_maps).set_class("agm-editor").modal(!0).content(jQuery("#map_container_src")).onclose((function(){jQuery(window).off("resize",i),jQuery(document).trigger("agm_map_editor_close"),n=null,t=null})).show(),n=t.$(),wpmUi.upgrade_tooltips(),jQuery(document).trigger("agm_map_editor_open"),jQuery(window).on("resize",i),!1})),jQuery(document).on("click",".agm-editor .maps_new_switch",v),jQuery(document).on("agm_map_editor_open",g),jQuery(document).on("agm_map_close",".agm-editor .map_preview_container",g),jQuery(document).on("click","li.existing_map_item .add_map_item",(function(){if(null!==n)return r(d(jQuery(this).parents("li").find("input:hidden").val(),function(){if(null===n)return;var e,t,a,i="";window.tinyMCE&&!jQuery("#content").is(":visible")?i=window.tinyMCE.activeEditor.selection.getContent():(e=jQuery("#content").get(0),void 0!==document.selection?(e.focus(),i=document.selection.createRange().text):void 0!==e.selectionStart&&(t=e.selectionStart,a=e.selectionEnd,i=e.value.substring(t,a)));return i}())),t.close(),!1})).on("click","li.existing_map_item .edit_map_item",(function(){if(null!==n){var e=jQuery(this).parents("li").find("input").val();jQuery.post(window.ajaxurl,{action:"agm_load_map",id:e},c),jQuery(".maps_new_switch_container",n).hide(),jQuery(".maps_advanced_container",n).hide(),jQuery(".maps_existing",n).hide()}})).on("click","li.existing_map_item .delete_map_item",(function(){if(null!==n){var e=jQuery(this).parents("li").find("input:hidden").val();t.confirm({message:l10nEditor.delete_confirmation,buttons:[l10nEditor.confirm_delete,l10nEditor.confirm_cancel],callback:function(t){0===t&&function(e){jQuery.post(window.ajaxurl,{action:"agm_delete_map",id:e},(function(e){o()}))}(e)}})}})),jQuery(document).on("agm_map_insert",".agm-editor .map_preview_container",(function(e,a){if(null!==n)return r(d(a)),t.close(),!1})),jQuery(document).on("click",".agm-editor .maps_advanced_switch",(function(){null!==n&&(n.hasClass("advanced-mode")?_():function(){if(null===n)return;n.addClass("advanced-mode"),jQuery("li.existing_map_item").each((function(){var e=jQuery(this),t=e.find("input:hidden").val(),n=jQuery('<div class="map_advanced_checkbox_container"><input type="checkbox" class="map_advanced_checkbox" value="'+t+'" /><div style="clear:both"></div></div>');e.addClass("advanced-mode"),jQuery(".map_advanced_checkbox",n).on("click",(function(){jQuery(this).prop("checked")?e.addClass("selected"):e.removeClass("selected"),l()})),e.prepend(n)})),jQuery(".advanced_mode_buttons",n).show(),jQuery(".maps_advanced_switch .text",n).text(l10nEditor.advanced_off),jQuery(".maps_merge_locations",n).click(u),jQuery(".maps_batch_delete",n).click(m),l()}())})),jQuery("body").on("mouseover","li.existing_map_item",(function(){jQuery(this).addClass("agm_active_item")})).on("mouseout","li.existing_map_item",(function(){jQuery(this).removeClass("agm_active_item")})))}));