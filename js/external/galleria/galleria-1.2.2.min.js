/**
 * @preserve Galleria v 1.2.2 2011-02-25
 * http://galleria.aino.se
 *
 * Copyright (c) 2011, Aino
 * Licensed under the MIT license.
 */
!function(t){var e,i,n=this,a=n.document,o=t(a),r=!1,s=navigator.userAgent.toLowerCase(),h=n.location.hash.replace(/#\//,""),c=function(){return x.TOUCH?"touchstart":"click"},l=function(){var t=3,i=a.createElement("div"),n=i.getElementsByTagName("i");do{i.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(n[0]);return t>4?t:e}(),u=function(){return{html:a.documentElement,body:a.body,head:a.getElementsByTagName("head")[0],title:a.title}},p="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",d=(i=[],t.each(p.split(" "),(function(t,e){i.push(e),/_/.test(e)&&i.push(e.replace(/_/g,""))})),i),g=function(e){var i;return"object"!=typeof e||t.each(e,(function(n,a){/^[a-z]+_/.test(n)&&(i="",t.each(n.split("_"),(function(t,e){i+=t>0?e.substr(0,1).toUpperCase()+e.substr(1):e})),e[i]=a,delete e[n])})),e},f=function(e){return t.inArray(e,d)>-1?x[e.toUpperCase()]:e},m={trunk:{},add:function(t,e,i,a){if(a=a||!1,this.clear(t),a){var o=e;e=function(){o(),m.add(t,e,i)}}this.trunk[t]=n.setTimeout(e,i)},clear:function(t){var e,i=function(t){n.clearTimeout(this.trunk[t]),delete this.trunk[t]};if(t&&t in this.trunk)i.call(m,t);else if(void 0===t)for(e in this.trunk)this.trunk.hasOwnProperty(e)&&i.call(m,e)}},y=[],_={array:function(t){return Array.prototype.slice.call(t)},create:function(t,e){e=e||"div";var i=a.createElement(e);return i.className=t,i},forceStyles:function(e,i){(e=t(e)).attr("style")&&e.data("styles",e.attr("style")).removeAttr("style"),e.css(i)},revertStyles:function(){t.each(_.array(arguments),(function(e,i){(i=t(i).removeAttr("style")).data("styles")&&i.attr("style",i.data("styles")).data("styles",null)}))},moveOut:function(t){_.forceStyles(t,{position:"absolute",left:-1e4})},moveIn:function(){_.revertStyles.apply(_,_.array(arguments))},hide:function(e,i,n){(e=t(e)).data("opacity")||e.data("opacity",e.css("opacity"));var a={opacity:0};i?e.stop().animate(a,i,n):e.css(a)},show:function(e,i,n){e=t(e);var a=parseFloat(e.data("opacity"))||1,o={opacity:a};1===a&&e.data("opacity",null),i?e.stop().animate(o,i,n):e.css(o)},addTimer:function(){return m.add.apply(m,_.array(arguments)),this},clearTimer:function(){return m.clear.apply(m,_.array(arguments)),this},wait:function(e){e=t.extend({until:function(){return!1},success:function(){},error:function(){x.raise("Could not complete wait function.")},timeout:3e3},e);var i,a,o=_.timestamp(),r=function(){return a=_.timestamp(),i=a-o,e.until(i)?(e.success(),!1):a>=o+e.timeout?(e.error(),!1):void n.setTimeout(r,2)};n.setTimeout(r,2)},toggleQuality:function(t,e){7!==l&&8!==l||!t||(void 0===e&&(e="nearest-neighbor"===t.style.msInterpolationMode),t.style.msInterpolationMode=e?"bicubic":"nearest-neighbor")},insertStyleTag:function(t){var e=a.createElement("style");if(u().head.appendChild(e),e.styleSheet)e.styleSheet.cssText=t;else{var i=a.createTextNode(t);e.appendChild(i)}},loadScript:function(e,i){var n=!1,a=t("<script>").attr({src:e,async:!0}).get(0);a.onload=a.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,a.onload=a.onreadystatechange=null,"function"==typeof i&&i.call(this,this))},u().head.appendChild(a)},parseValue:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=t.match(/\-?\d/g);return e&&e.constructor===Array?parseInt(e.join(""),10):0}return 0},timestamp:function(){return(new Date).getTime()},loadCSS:function(i,o,s){var h,c,p=!1;return t("link[rel=stylesheet]").each((function(){if(new RegExp(i).test(this.href))return h=this,!1})),"function"==typeof o&&(s=o,o=e),s=s||function(){},h?(s.call(h,h),h):(c=a.styleSheets.length,r&&(i+="?"+_.timestamp()),t("#"+o).length?(t("#"+o).attr("href",i),c--,p=!0):(h=t("<link>").attr({rel:"stylesheet",href:i,id:o}).get(0),n.setTimeout((function(){var e=t('link[rel="stylesheet"], style');e.length?e.get(0).parentNode.insertBefore(h,e[0]):u().head.appendChild(h),l?h.attachEvent("onreadystatechange",(function(t){"complete"===h.readyState&&(p=!0)})):p=!0}),10)),"function"==typeof s&&_.wait({until:function(){return p&&a.styleSheets.length>c},success:function(){_.addTimer("css",(function(){s.call(h,h)}),100)},error:function(){x.raise("Theme CSS could not load")},timeout:1e3}),h)}},v={fade:function(e,i){t(e.next).css("opacity",0).show().animate({opacity:1},e.speed,i),e.prev&&t(e.prev).css("opacity",1).show().animate({opacity:0},e.speed)},flash:function(e,i){t(e.next).css("opacity",0),e.prev?t(e.prev).animate({opacity:0},e.speed/2,(function(){t(e.next).animate({opacity:1},e.speed,i)})):t(e.next).animate({opacity:1},e.speed,i)},pulse:function(e,i){e.prev&&t(e.prev).hide(),t(e.next).css("opacity",0).animate({opacity:1},e.speed,i)},slide:function(e,i){var n=t(e.next).parent(),a=this.$("images"),o=this._stageWidth,r=this.getOptions("easing");n.css({left:o*(e.rewind?-1:1)}),a.animate({left:o*(e.rewind?1:-1)},{duration:e.speed,queue:!1,easing:r,complete:function(){a.css("left",0),n.css("left",0),i()}})},fadeslide:function(e,i){var n=0,a=this.getOptions("easing"),o=this.getStageWidth();e.prev&&(n=_.parseValue(t(e.prev).css("left")),t(e.prev).css({opacity:1,left:n}).animate({opacity:0,left:n+o*(e.rewind?1:-1)},{duration:e.speed,queue:!1,easing:a})),n=_.parseValue(t(e.next).css("left")),t(e.next).css({left:n+o*(e.rewind?-1:1),opacity:0}).animate({opacity:1,left:n},{duration:e.speed,complete:i,queue:!1,easing:a})}},x=function(){var i=this;this._theme=e,this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._initialized=!1,this._stageWidth=0,this._stageHeight=0,this._target=e,this._id=Math.random();t.each("container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description info-author thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip".split(" "),(function(t,e){i._dom[e]=_.create("galleria-"+e)})),t.each("current total".split(" "),(function(t,e){i._dom[e]=_.create("galleria-"+e,"span")}));var a=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var e=t.keyCode||t.which;e in a.map&&"function"==typeof a.map[e]&&a.map[e].call(i,t)},attach:function(t){var e,i;for(e in t)t.hasOwnProperty(e)&&(i=e.toUpperCase())in a.keys&&(a.map[a.keys[i]]=t[e]);a.bound||(a.bound=!0,o.on("keydown",a.press))},detach:function(){a.bound=!1,o.off("keydown",a.press)}},r=this._controls={0:e,1:e,active:0,swap:function(){r.active=r.active?0:1},getActive:function(){return r[r.active]},getNext:function(){return r[1-r.active]}},s=this._carousel={next:i.$("thumb-nav-right"),prev:i.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var e=0,n=0,a=[0];t.each(i._thumbnails,(function(i,o){o.ready&&(e+=o.outerWidth||t(o.container).outerWidth(!0),a[i+1]=e,n=Math.max(n,o.outerHeight||t(o.container).outerHeight(!0)))})),i.$("thumbnails").css({width:e,height:n}),s.max=e,s.hooks=a,s.width=i.$("thumbnails-list").width(),s.setClasses(),i.$("thumbnails-container").toggleClass("galleria-carousel",e>s.width)},bindControls:function(){var t;s.next.on(c(),(function(e){if(e.preventDefault(),"auto"===i._options.carouselSteps){for(t=s.current;t<s.hooks.length;t++)if(s.hooks[t]-s.hooks[s.current]>s.width){s.set(t-2);break}}else s.set(s.current+i._options.carouselSteps)})),s.prev.on(c(),(function(e){if(e.preventDefault(),"auto"===i._options.carouselSteps)for(t=s.current;t>=0;t--){if(s.hooks[s.current]-s.hooks[t]>s.width){s.set(t+2);break}if(0===t){s.set(0);break}}else s.set(s.current-i._options.carouselSteps)}))},set:function(t){for(t=Math.max(t,0);s.hooks[t-1]+s.width>=s.max&&t>=0;)t--;s.current=t,s.animate()},getLast:function(t){return(t||s.current)-1},follow:function(t){if(0!==t&&t!==s.hooks.length-2){for(var e=s.current;s.hooks[e]-s.hooks[s.current]<s.width&&e<=s.hooks.length;)e++;t-1<s.current?s.set(t-1):t+2>e&&s.set(t-e+s.current+2)}else s.set(t)},setClasses:function(){s.prev.toggleClass("disabled",!s.current),s.next.toggleClass("disabled",s.hooks[s.current]+s.width>=s.max)},animate:function(t){s.setClasses();var e=-1*s.hooks[s.current];isNaN(e)||i.$("thumbnails").animate({left:e},{duration:i._options.carouselSpeed,easing:i._options.easing,queue:!1})}},h=this._tooltip={initialized:!1,open:!1,init:function(){h.initialized=!0;_.insertStyleTag(".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}"),i.$("tooltip").css("opacity",.8),_.hide(i.get("tooltip"))},move:function(t){var e=i.getMousePosition(t).x,n=i.getMousePosition(t).y,a=i.$("tooltip"),o=e,r=n,s=a.outerHeight(!0)+1,h=a.outerWidth(!0),c=s+15,l=i.$("container").width()-h-2,u=i.$("container").height()-s-2;isNaN(o)||isNaN(r)||(o+=10,r-=30,o=Math.max(0,Math.min(l,o)),r=Math.max(0,Math.min(u,r)),n<c&&(r=c),a.css({left:o,top:r}))},bind:function(e,n){h.initialized||h.init();var a=function(e,n){h.define(e,n),t(e).hover((function(){_.clearTimer("switch_tooltip"),i.$("container").off("mousemove",h.move).on("mousemove",h.move).trigger("mousemove"),h.show(e),x.utils.addTimer("tooltip",(function(){i.$("tooltip").stop().show(),_.show(i.get("tooltip"),400),h.open=!0}),h.open?0:500)}),(function(){i.$("container").off("mousemove",h.move),_.clearTimer("tooltip"),i.$("tooltip").stop(),_.hide(i.get("tooltip"),200,(function(){i.$("tooltip").hide(),_.addTimer("switch_tooltip",(function(){h.open=!1}),1e3)}))}))};"string"==typeof n?a(e in i._dom?i.get(e):e,n):t.each(e,(function(t,e){a(i.get(t),e)}))},show:function(e){var a=(e=t(e in i._dom?i.get(e):e)).data("tt"),o=function(t){var i;n.setTimeout((i=t,function(){h.move(i)}),10),e.off("mouseup",o)};(a="function"==typeof a?a():a)&&(i.$("tooltip").html(a.replace(/\s/,"&nbsp;")),e.on("mouseup",o))},define:function(e,n){if("function"!=typeof n){var a=n;n=function(){return a}}e=t(e in i._dom?i.get(e):e).data("tt",n),h.show(e)}},p=this._fullscreen={scrolled:0,active:!1,enter:function(e){p.active=!0,_.hide(i.getActiveImage()),i.$("container").addClass("fullscreen"),p.scrolled=t(n).scrollTop(),_.forceStyles(i.get("container"),{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4});var a={height:"100%",overflow:"hidden",margin:0,padding:0};_.forceStyles(u().html,a),_.forceStyles(u().body,a),i.attachKeyboard({escape:i.exitFullscreen,right:i.next,left:i.prev}),i.rescale((function(){_.addTimer("fullscreen_enter",(function(){_.show(i.getActiveImage()),"function"==typeof e&&e.call(i)}),100),i.trigger(x.FULLSCREEN_ENTER)})),t(n).on("resize",(function(){p.scale()}))},scale:function(){i.rescale()},exit:function(e){p.active=!1,_.hide(i.getActiveImage()),i.$("container").removeClass("fullscreen"),_.revertStyles(i.get("container"),u().html,u().body),n.scrollTo(0,p.scrolled),i.detachKeyboard(),i.rescale((function(){_.addTimer("fullscreen_exit",(function(){_.show(i.getActiveImage()),"function"==typeof e&&e.call(i)}),50),i.trigger(x.FULLSCREEN_EXIT)})),t(n).off("resize",p.scale)}},d=this._idle={trunk:[],bound:!1,add:function(e,i){if(e){d.bound||d.addEvent(),e=t(e);var n,a={};for(n in i)i.hasOwnProperty(n)&&(a[n]=e.css(n));e.data("idle",{from:a,to:i,complete:!0,busy:!1}),d.addTimer(),d.trunk.push(e)}},remove:function(e){e=jQuery(e),t.each(d.trunk,(function(t,n){n.length&&!n.not(e).length&&(i._idle.show(e),i._idle.trunk.splice(t,1))})),d.trunk.length||(d.removeEvent(),_.clearTimer("idle"))},addEvent:function(){d.bound=!0,i.$("container").on("mousemove click",d.showAll)},removeEvent:function(){d.bound=!1,i.$("container").off("mousemove click",d.showAll)},addTimer:function(){_.addTimer("idle",(function(){i._idle.hide()}),i._options.idleTime)},hide:function(){i.trigger(x.IDLE_ENTER),t.each(d.trunk,(function(t,e){var n=e.data("idle");n&&(e.data("idle").complete=!1,e.stop().animate(n.to,{duration:i._options.idleSpeed,queue:!1,easing:"swing"}))}))},showAll:function(){_.clearTimer("idle"),t.each(i._idle.trunk,(function(t,e){i._idle.show(e)}))},show:function(e){var n=e.data("idle");n.busy||n.complete||(n.busy=!0,i.trigger(x.IDLE_EXIT),_.clearTimer("idle"),e.stop().animate(n.from,{duration:i._options.idleSpeed/2,queue:!1,easing:"swing",complete:function(){t(this).data("idle").busy=!1,t(this).data("idle").complete=!0}})),d.addTimer()}},g=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},init:function(){if(i.trigger(x.LIGHTBOX_OPEN),!g.initialized){g.initialized=!0;var e={},n=i._options,a="",o="position:absolute;",r="lightbox-",s={overlay:"position:fixed;display:none;opacity:"+n.overlayOpacity+";filter:alpha(opacity="+100*n.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+n.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:o+"background:#000;width:100%;height:100%;",content:o+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:o+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:o+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:o+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:o+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:o+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:o+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;line-height:40px;text-align:center;color:#000",next:o+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;line-height:40px;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},h={};8===l&&(s.nextholder+="background:#000;filter:alpha(opacity=0);",s.prevholder+="background:#000;filter:alpha(opacity=0);"),t.each(s,(function(t,e){a+=".galleria-"+r+t+"{"+e+"}"})),_.insertStyleTag(a),t.each("overlay box content shadow title info close prevholder prev nextholder next counter image".split(" "),(function(t,n){i.addElement("lightbox-"+n),e[n]=g.elems[n]=i.get("lightbox-"+n)})),g.image=new x.Picture,t.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},(function(e,i){var n=[];t.each(i.split(" "),(function(t,e){n.push(r+e)})),h[r+e]=n})),i.append(h),t(e.image).append(g.image.container),t(u().body).append(e.overlay,e.box),t(e.close).on(c(),g.hide).html("&#215;").hover((function(){t(this).css("color","#bbb")}),(function(){t(this).css("color","#444")})),t.each(["Prev","Next"],(function(i,n){var a=t(e[n.toLowerCase()]).html(/v/.test(n)?"&#8249;&nbsp;":"&nbsp;&#8250;"),o=t(e[n.toLowerCase()+"holder"]);o.on(c(),(function(){g["show"+n]()})),l<8?a.show():o.hover((function(){a.show()}),(function(t){a.stop().fadeOut(200)}))})),t(e.overlay).on(c(),g.hide)}},rescale:function(e){var a=Math.min(t(n).width()-40,g.width),o=Math.min(t(n).height()-60,g.height),r=Math.min(a/g.width,o/g.height),s=g.width*r+40,h=g.height*r+60,c={width:s,height:h,marginTop:-1*Math.ceil(h/2),marginLeft:-1*Math.ceil(s/2)};e?t(g.elems.box).css(c):t(g.elems.box).animate(c,i._options.lightboxTransitionSpeed,i._options.easing,(function(){var t=g.image,e=i._options.lightboxFadeSpeed;i.trigger({type:x.LIGHTBOX_IMAGE,imageTarget:t.image}),t.show(),_.show(t.image,e),_.show(g.elems.info,e)}))},hide:function(){g.image.image=null,t(n).off("resize",g.rescale),t(g.elems.box).hide(),_.hide(g.elems.info),_.hide(g.elems.overlay,200,(function(){t(this).hide().css("opacity",i._options.overlayOpacity),i.trigger(x.LIGHTBOX_CLOSE)}))},showNext:function(){g.show(i.getNext(g.active))},showPrev:function(){g.show(i.getPrev(g.active))},show:function(e){g.active=e="number"==typeof e?e:i.getIndex(),g.initialized||g.init(),t(n).off("resize",g.rescale);var a=i.getData(e),o=i.getDataLength();_.hide(g.elems.info),g.image.load(a.image,(function(i){g.width=i.original.width,g.height=i.original.height,t(i.image).css({width:"100.5%",height:"100.5%",top:0,zIndex:99998,opacity:0}),g.elems.title.innerHTML=a.title,g.elems.counter.innerHTML=e+1+" / "+o,t(n).on("resize",g.rescale),g.rescale()})),t(g.elems.overlay).show(),t(g.elems.box).show()}};return this};x.prototype={constructor:x,init:function(i,n){var a=this;n=g(n),y.push(this),this._original={target:i,options:n,data:null},this._target=this._dom.target=i.nodeName?i:t(i).get(0),this._target?(this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dataConfig:function(t){return{}},dataSelector:"img",dataSource:this._target,debug:e,easing:"galleria",extend:function(t){},height:"auto",idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",keepSource:!1,lightboxFadeSpeed:200,lightboxTransition_speed:500,linkSourceTmages:!0,maxScaleRatio:e,minScaleRatio:e,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,thumbCrop:!0,thumbEventType:c(),thumbFit:!0,thumbMargin:0,thumbQuality:"auto",thumbnails:!0,transition:"fade",transitionInitial:e,transitionSpeed:400,width:"auto"},n&&!0===n.debug&&(r=!0),t(this._target).children().hide(),"object"==typeof x.theme?this._init():_.wait({until:function(){return"object"==typeof x.theme},success:function(){a._init.call(a)},error:function(){x.raise("No theme found.",!0)},timeout:5e3})):x.raise("Target not found.")},_init:function(){var i=this;if(this._initialized)return x.raise("Init failed: Gallery instance already initialized."),this;if(this._initialized=!0,!x.theme)return x.raise("Init failed: No theme found."),this;t.extend(!0,this._options,x.theme.defaults,this._original.options),this.on(x.DATA,(function(){this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();var e=this.$("container"),a={width:0,height:0},o=_.create("galleria-image");_.wait({until:function(){t.each(["width","height"],(function(t,n){i._options[n]&&"number"==typeof i._options[n]?a[n]=i._options[n]:a[n]=Math.max(_.parseValue(e.css(n)),_.parseValue(i.$("target").css(n)),e[n](),i.$("target")[n]())}));var n=function(){return!0};return i._options.thumbnails&&(i.$("thumbnails").append(o),n=function(){return!!t(o).height()}),n()&&a.width&&a.height>10},success:function(){t(o).remove(),e.width(a.width),e.height(a.height),x.WEBKIT?n.setTimeout((function(){i._run()}),1):i._run()},error:function(){x.raise("Width & Height not found.",!0)},timeout:2e3})}));return this.on(x.READY,function(a){return function(){_.show(this.get("counter")),this._options.carousel&&this._carousel.bindControls(),this._options.autoplay&&(this.pause(),"number"==typeof this._options.autoplay&&(this._playtime=this._options.autoplay),this.trigger(x.PLAY),this._playing=!0),a?"number"==typeof this._options.show&&this.show(this._options.show):(a=!0,this._options.clicknext&&(t.each(this._data,(function(t,e){delete e.link})),this.$("stage").css({cursor:"pointer"}).on(c(),(function(t){i.next()}))),x.History&&x.History.change((function(t){var a=parseInt(t.value.replace(/\//,""),10);isNaN(a)?n.history.go(-1):i.show(a,e,!0)})),x.theme.init.call(this,this._options),this._options.extend.call(this,this._options),/^[0-9]{1,4}$/.test(h)&&x.History?this.show(h,e,!0):this.show(this._options.show))}}(!1)),this.append({"info-text":["info-title","info-description","info-author"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),_.hide(this.$("counter").append(this.get("current")," / ",this.get("total"))),this.setCounter("&#8211;"),_.hide(i.get("tooltip")),t.each(new Array(2),(function(e){var n=new x.Picture;t(n.container).css({position:"absolute",top:0,left:0}),i.$("images").append(n.container),i._controls[e]=n})),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").on(c(),(function(t){i._options.clicknext&&t.stopPropagation(),i._options.pause_on_interaction&&i.pause();var e=/right/.test(this.className)?"next":"prev";i[e]()})),t.each(["info","counter","image-nav"],(function(t,e){!1===i._options["show"+e.substr(0,1).toUpperCase()+e.substr(1).replace(/-/,"")]&&_.moveOut(i.get(e.toLowerCase()))})),this.load(),this._options.keep_source||l||(this._target.innerHTML=""),this.$("target").append(this.get("container")),this._options.carousel&&this.on(x.THUMBNAIL,(function(){this.updateCarousel()})),this},_createThumbnails:function(){var e,i,o,r,s,h,c=this,l=this._options,u=!!(h=c.$("thumbnails").find(".active")).length&&h.find("img").attr("src"),p="string"==typeof l.thumbnails?l.thumbnails.toLowerCase():null,d=function(t){return a.defaultView&&a.defaultView.getComputedStyle?a.defaultView.getComputedStyle(o.container,null)[t]:s.css(t)},g=function(e,i,n){return function(){t(n).append(e),c.trigger({type:x.THUMBNAIL,thumbTarget:e,index:i})}},f=function(e){l.pauseOnInteraction&&c.pause();var i=t(e.currentTarget).data("index");c.getIndex()!==i&&c.show(i),e.preventDefault()},m=function(e){e.scale({width:e.data.width,height:e.data.height,crop:l.thumbCrop,margin:l.thumbMargin,complete:function(e){var i,n,a=["left","top"];t.each(["Width","Height"],(function(o,r){i=r.toLowerCase(),!0===l.thumbCrop&&l.thumbCrop!==i||!l.thumbFit||((n={})[i]=e[i],t(e.container).css(n),(n={})[a[o]]=0,t(e.image).css(n)),e["outer"+r]=t(e.container)["outer"+r](!0)})),_.toggleQuality(e.image,!0===l.thumbQuality||"auto"===l.thumbQuality&&e.original.width<3*e.width),c.trigger({type:x.THUMBNAIL,thumbTarget:e.image,index:e.data.order})}})};for(this._thumbnails=[],this.$("thumbnails").empty(),e=0;this._data[e];e++)r=this._data[e],!0===l.thumbnails?(o=new x.Picture(e),i=r.thumb||r.image,this.$("thumbnails").append(o.container),s=t(o.container),o.data={width:_.parseValue(d("width")),height:_.parseValue(d("height")),order:e},l.thumbFit&&!0!==l.thumbCrop?s.css({width:0,height:0}):s.css({width:o.data.width,height:o.data.height}),o.load(i,m),"all"===l.preload&&o.add(r.image)):"empty"===p||"numbers"===p?(o={container:_.create("galleria-image"),image:_.create("img","span"),ready:!0},"numbers"===p&&t(o.image).text(e+1),this.$("thumbnails").append(o.container),n.setTimeout(g(o.image,e,o.container),50+20*e)):o={container:null,image:null},t(o.container).add(l.keepSource&&l.linkSourceImages?r.original:null).data("index",e).on(l.thumbEventType,f),u===i&&t(o.container).addClass("active"),this._thumbnails.push(o)},_run:function(){var t=this;t._createThumbnails(),_.wait({until:function(){return x.OPERA&&t.$("stage").css("display","inline-block"),t._stageWidth=t.$("stage").width(),t._stageHeight=t.$("stage").height(),t._stageWidth&&t._stageHeight>50},success:function(){t.trigger(x.READY)},error:function(){x.raise("Stage measures not found",!0)}})},load:function(e,i,n){var a=this;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof i&&(n=i,i=null),e=e||this._options.dataSource,i=i||this._options.dataSelector,n=n||this._options.dataConfig,e.constructor===Array?(this.validate(e)?(this._data=e,this._parseData().trigger(x.DATA)):x.raise("Load failed: JSON Array not valid."),this):(t(e).find(i).each((function(e,i){var o={},r=(i=t(i)).parent().attr("href");/\.(png|gif|jpg|jpeg)(\?.*)?$/i.test(r)?o.image=r:r&&(o.link=r),a._data.push(t.extend({title:i.attr("title"),thumb:i.attr("src"),image:i.attr("src"),description:i.attr("alt"),link:i.attr("longdesc"),original:i.get(0)},o,n(i)))})),this.getDataLength()?this.trigger(x.DATA):x.raise("Load failed: no data found."),this)},_parseData:function(){var e=this;return t.each(this._data,(function(t,i){"thumb"in i==!1&&(e._data[t].thumb=i.image)})),this},splice:function(){return Array.prototype.splice.apply(this._data,_.array(arguments)),this._parseData()._createThumbnails()},push:function(){return Array.prototype.push.apply(this._data,_.array(arguments)),this._parseData()._createThumbnails()},_getActive:function(){return this._controls.getActive()},validate:function(t){return!0},bind:function(t,e){return t=f(t),this.$("container").on(t,this.proxy(e)),this},unbind:function(t){return t=f(t),this.$("container").off(t),this},trigger:function(e){return e="object"==typeof e?t.extend(e,{scope:this}):{type:f(e),scope:this},this.$("container").trigger(e),this},addIdleState:function(t,e){return this._idle.add.apply(this._idle,_.array(arguments)),this},removeIdleState:function(t){return this._idle.remove.apply(this._idle,_.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(t){return this._fullscreen.enter.apply(this,_.array(arguments)),this},exitFullscreen:function(t){return this._fullscreen.exit.apply(this,_.array(arguments)),this},toggleFullscreen:function(t){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,_.array(arguments)),this},bindTooltip:function(t,e){return this._tooltip.bind.apply(this._tooltip,_.array(arguments)),this},defineTooltip:function(t,e){return this._tooltip.define.apply(this._tooltip,_.array(arguments)),this},refreshTooltip:function(t){return this._tooltip.show.apply(this._tooltip,_.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,_.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,_.array(arguments)),this},getActiveImage:function(){return this._getActive().image||e},getActiveThumb:function(){return this._thumbnails[this._active].image||e},getMousePosition:function(t){return{x:t.pageX-this.$("container").offset().left,y:t.pageY-this.$("container").offset().top}},addPan:function(e){if(!1!==this._options.imageCrop){e=t(e||this.getActiveImage());var i=this,n=e.width()/2,a=e.height()/2,o=parseInt(e.css("left"),10),r=parseInt(e.css("top"),10),s=o||0,h=r||0,c=0,u=0,p=!1,d=_.timestamp(),g=0,f=0,m=function(t,i,n){if(t>0&&(f=Math.round(Math.max(-1*t,Math.min(0,i))),g!==f))if(g=f,8===l)e.parent()["scroll"+n](-1*f);else{var a={};a[n.toLowerCase()]=f,e.css(a)}},y=function(t){_.timestamp()-d<50||(p=!0,n=i.getMousePosition(t).x,a=i.getMousePosition(t).y)};return 8===l&&(e.parent().scrollTop(-1*h).scrollLeft(-1*s),e.css({top:0,left:0})),this.$("stage").off("mousemove",y).on("mousemove",y),_.addTimer("pan",(function(t){p&&(c=e.width()-i._stageWidth,u=e.height()-i._stageHeight,o=n/i._stageWidth*c*-1,r=a/i._stageHeight*u*-1,s+=(o-s)/i._options.imagePanSmoothness,h+=(r-h)/i._options.imagePanSmoothness,m(u,h,"Top"),m(c,s,"Left"))}),50,!0),this}},proxy:function(t,e){return"function"!=typeof t?function(){}:(e=e||this,function(){return t.apply(e,_.array(arguments))})},removePan:function(){return this.$("stage").off("mousemove"),_.clearTimer("pan"),this},addElement:function(e){var i=this._dom;return t.each(_.array(arguments),(function(t,e){i[e]=_.create("galleria-"+e)})),this},attachKeyboard:function(t){return this._keyboard.attach.apply(this._keyboard,_.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,_.array(arguments)),this},appendChild:function(t,e){return this.$(t).append(this.get(e)||e),this},prependChild:function(t,e){return this.$(t).prepend(this.get(e)||e),this},remove:function(t){return this.$(_.array(arguments).join(",")).remove(),this},append:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e))if(t[e].constructor===Array)for(i=0;t[e][i];i++)this.appendChild(e,t[e][i]);else this.appendChild(e,t[e]);return this},_scaleImage:function(e,i){return i=t.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition},i),(e||this._controls.getActive()).scale(i),this},updateCarousel:function(){return this._carousel.update(),this},rescale:function(t,i,n){var a=this;"function"==typeof t&&(n=t,t=e);var o=function(){a._stageWidth=t||a.$("stage").width(),a._stageHeight=i||a.$("stage").height(),a._scaleImage(),a._options.carousel&&a.updateCarousel(),a.trigger(x.RESCALE),"function"==typeof n&&n.call(a)};return!x.WEBKIT||t||i?o.call(a):_.addTimer("scale",o,5),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(t,e,i){if(!1!==t&&(this._options.queue||!this._queue.stalled)){if(t=Math.max(0,Math.min(parseInt(t,10),this.getDataLength()-1)),e=void 0!==e?!!e:t<this.getIndex(),(i=i||!1)||!x.History)return this._active=t,Array.prototype.push.call(this._queue,{index:t,rewind:e}),this._queue.stalled||this._show(),this;x.History.value(t.toString())}},_show:function(){var e=this,i=this._queue[0],a=this.getData(i.index);if(a){var o=a.image,r=this._controls.getActive(),s=this._controls.getNext(),h=s.isCached(o),l=this._thumbnails[i.index],u=function(){e._queue.stalled=!1,_.toggleQuality(s.image,e._options.imageQuality),t(r.container).css({zIndex:0,opacity:0}),t(s.container).css({zIndex:1,opacity:1}),e._controls.swap(),e._options.imagePan&&e.addPan(s.image),a.link&&t(s.image).css({cursor:"pointer"}).on(c(),(function(){e._options.popupLinks?n.open(a.link,"_blank"):n.location.href=a.link})),Array.prototype.shift.call(e._queue),e._queue.length&&e._show(),e._playCheck(),e.trigger({type:x.IMAGE,index:i.index,imageTarget:s.image,thumbTarget:l.image})};if(this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(i.index),this._options.preload){var p,d=this.getNext();try{for(p=this._options.preload;p>0;p--)(new x.Picture).add(e.getData(d).image),d=e.getNext(d)}catch(t){}}_.show(s.container),t(e._thumbnails[i.index].container).addClass("active").siblings(".active").removeClass("active"),e.trigger({type:x.LOADSTART,cached:h,index:i.index,imageTarget:s.image,thumbTarget:l.image}),s.load(o,(function(t){e._scaleImage(t,{complete:function(t){_.show(t.container),"image"in r&&_.toggleQuality(r.image,!1),_.toggleQuality(t.image,!1),e._queue.stalled=!0,e.removePan(),e.setInfo(i.index),e.setCounter(i.index),e.trigger({type:x.LOADFINISH,cached:h,index:i.index,imageTarget:t.image,thumbTarget:e._thumbnails[i.index].image});var n=null===r.image&&e._options.transitionInitial?e._options.transition_Initial:e._options.transition;if(n in v==!1)u();else{var a={prev:r.image,next:t.image,rewind:i.rewind,speed:e._options.transitionSpeed||400};v[n].call(e,a,u)}}})}))}},getNext:function(t){return(t="number"==typeof t?t:this.getIndex())===this.getDataLength()-1?0:t+1},getPrev:function(t){return 0===(t="number"==typeof t?t:this.getIndex())?this.getDataLength()-1:t-1},next:function(){return this.getDataLength()>1&&this.show(this.getNext(),!1),this},prev:function(){return this.getDataLength()>1&&this.show(this.getPrev(),!0),this},get:function(t){return t in this._dom?this._dom[t]:null},getData:function(t){return t in this._data?this._data[t]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active&&this._active},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(t){return void 0===t?this._options:this._options[t]},setOptions:function(e,i){return"object"==typeof e?t.extend(this._options,e):this._options[e]=i,this},play:function(t){return this._playing=!0,this._playtime=t||this._playtime,this._playCheck(),this.trigger(x.PLAY),this},pause:function(){return this._playing=!1,this.trigger(x.PAUSE),this},playToggle:function(t){return this._playing?this.pause():this.play(t)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var t=this,e=0,i=_.timestamp(),n="play"+this._id;if(this._playing){_.clearTimer(n);var a=function(){if((e=_.timestamp()-i)>=t._playtime&&t._playing)return _.clearTimer(n),void t.next();t._playing&&(t.trigger({type:x.PROGRESS,percent:Math.ceil(e/t._playtime*100),seconds:Math.floor(e/1e3),milliseconds:e}),_.addTimer(n,a,20))};_.addTimer(n,a,20)}},setIndex:function(t){return this._active=t,this},setCounter:function(t){if("number"==typeof t?t++:void 0===t&&(t=this.getIndex()+1),this.get("current").innerHTML=t,l){var e=this.$("counter"),i=e.css("opacity"),n=e.attr("style");n&&1===parseInt(i,10)?e.attr("style",n.replace(/filter[^\;]+\;/i,"")):this.$("counter").css("opacity",i)}return this},setInfo:function(e){var i=this,n=this.getData(e);return t.each(["title","description","author"],(function(t,e){var a=i.$("info-"+e);n[e]?a[n[e].length?"show":"hide"]().html(n[e]):a.empty().hide()})),this},hasInfo:function(t){var e,i="title description".split(" ");for(e=0;i[e];e++)if(this.getData(t)[i[e]])return!0;return!1},jQuery:function(e){var i=this,n=[];t.each(e.split(","),(function(e,a){a=t.trim(a),i.get(a)&&n.push(a)}));var a=t(i.get(n.shift()));return t.each(n,(function(t,e){a=a.add(i.get(e))})),a},$:function(t){return this.jQuery.apply(this,_.array(arguments))}},t.each(d,(function(t,e){var i=/_/.test(e)?e.replace(/_/g,""):e;x[e.toUpperCase()]="galleria."+i})),t.extend(x,{IE9:9===l,IE8:8===l,IE7:7===l,IE6:6===l,IE:!!l,WEBKIT:/webkit/.test(s),SAFARI:/safari/.test(s),CHROME:/chrome/.test(s),QUIRK:l&&a.compatMode&&"BackCompat"===a.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!n.opera,IPHONE:/iphone/.test(s),IPAD:/ipad/.test(s),ANDROID:/android/.test(s),TOUCH:!!(/iphone/.test(s)||/ipad/.test(s)||/android/.test(s))}),x.addTheme=function(e){e.name||x.raise("No theme name specified"),"object"!=typeof e.defaults?e.defaults={}:e.defaults=g(e.defaults);var i=!1;return"string"==typeof e.css?(t("link").each((function(t,n){if(new RegExp(e.css).test(n.href))return i=!0,x.theme=e,!1})),i||t("script").each((function(t,n){new RegExp("galleria\\."+e.name.toLowerCase()+"\\.").test(n.src)&&(i=n.src.replace(/[^\/]*$/,"")+e.css,_.addTimer("css",(function(){_.loadCSS(i,"galleria-theme",(function(){x.theme=e}))}),1))})),i||x.raise("No theme CSS loaded")):x.theme=e,e},x.loadTheme=function(i,n){var a=!1,o=y.length;x.theme=e,_.loadScript(i,(function(){a=!0})),_.wait({until:function(){return a},error:function(){x.raise("Theme at "+i+" could not load, check theme path.",!0)},success:function(){if(o){var e=[];t.each(x.get(),(function(i,a){var o=t.extend(a._original.options,{data_source:a._data},n);a.$("container").remove();var r=new x;r._id=a._id,r.init(a._original.target,o),e.push(r)})),y=e}},timeout:2e3})},x.get=function(t){return y[t]?y[t]:"number"!=typeof t?y:void x.raise("Gallery index "+t+" not found")},x.addTransition=function(t,e){v[t]=e},x.utils=_,x.log=function(){try{n.console.log.apply(n.console,_.array(arguments))}catch(t){try{n.opera.postError.apply(n.opera,arguments)}catch(t){n.alert(_.array(arguments).split(", "))}}},x.raise=function(t,e){if(r||e)throw new Error((e?"Fatal error":"Error")+": "+t)},x.Picture=function(e){this.id=e||null,this.image=null,this.container=_.create("galleria-image"),t(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.loaded=!1},x.Picture.prototype={cache:{},add:function(e){var i=0,n=this,a=new Image,o=function(){this.width&&this.height||!(i<1e3)||(i++,t(a).load(o).attr("src",e+"?"+(new Date).getTime())),n.original={height:this.height,width:this.width},n.cache[e]=e,n.loaded=!0};return t(a).css("display","block"),n.cache[e]?(a.src=e,o.call(a),a):(t(a).load(o).attr("src",e),a)},show:function(){_.show(this.image)},hide:function(){_.moveOut(this.image)},clear:function(){this.image=null},isCached:function(t){return!!this.cache[t]},load:function(e,i){var a=this;return t(this.container).empty(!0),this.image=this.add(e),_.hide(this.image),t(this.container).append(this.image),_.wait({until:function(){return a.loaded&&a.image.complete&&a.original.width&&a.image.width},success:function(){n.setTimeout((function(){i.call(a,a)}),50)},error:function(){n.setTimeout((function(){i.call(a,a)}),50),x.raise("image not loaded in 10 seconds: "+e)},timeout:1e4}),this.container},scale:function(i){if(i=t.extend({width:0,height:0,min:e,max:e,margin:0,complete:function(){},position:"center",crop:!1},i),!this.image)return this.container;var n,a,o=this,r=t(o.container);return _.wait({until:function(){return n=i.width||r.width()||_.parseValue(r.css("width")),a=i.height||r.height()||_.parseValue(r.css("height")),n&&a},success:function(){var e=(n-2*i.margin)/o.original.width,r=(a-2*i.margin)/o.original.height,s={true:Math.max(e,r),width:e,height:r,false:Math.min(e,r)}[i.crop.toString()];i.max&&(s=Math.min(i.max,s)),i.min&&(s=Math.max(i.min,s)),t(o.container).width(n).height(a),t.each(["width","height"],(function(e,i){t(o.image)[i](o.image[i]=o[i]=Math.round(o.original[i]*s))}));var h={},c={},l=function(e,i,n){var a=0;if(/\%/.test(e)){var r=parseInt(e,10)/100,s=o.image[i]||t(o.image)[i]();a=Math.ceil(-1*s*r+n*r)}else a=_.parseValue(e);return a},u={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};t.each(i.position.toLowerCase().split(" "),(function(t,e){"center"===e&&(e="50%"),h[t?"top":"left"]=e})),t.each(h,(function(e,i){u.hasOwnProperty(i)&&t.extend(c,u[i])})),h=h.top?t.extend(h,c):c,h=t.extend({top:"50%",left:"50%"},h),t(o.image).css({position:"relative",top:l(h.top,"height",a),left:l(h.left,"width",n)}),o.show(),o.ready=!0,i.complete.call(o,o)},error:function(){x.raise("Could not scale image: "+o.image.src)},timeout:1e3}),this}},t.extend(t.easing,{galleria:function(t,e,i,n,a){return(e/=a/2)<1?n/2*e*e*e*e+i:-n/2*((e-=2)*e*e*e-2)+i},galleriaIn:function(t,e,i,n,a){return n*(e/=a)*e*e*e+i},galleriaOut:function(t,e,i,n,a){return-n*((e=e/a-1)*e*e*e-1)+i}}),t.fn.galleria=function(t){return this.each((function(){(new x).init(this,t)}))},n.Galleria=x}(jQuery);